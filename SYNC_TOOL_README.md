# 文件同步工具

这是一个用于将客户端文件夹及子文件夹内所有文件同步到服务端的工具。支持通过启动参数或菜单选择启动服务端或客户端模式。同步方式为覆盖同步，服务端记录同步日志。

## 功能特点

- 支持客户端和服务端模式
- 客户端将文件夹及子文件夹内所有文件同步到服务端
- 同步方式为覆盖同步
- 服务端记录同步日志
- 通过启动参数或菜单选择模式
- 支持文件哈希验证，确保文件完整性
- 支持大文件传输

## 系统要求

- Python 3.6+
- 支持Windows、Linux和macOS

## 安装

无需安装，直接运行Python脚本即可。

## 使用方法

### 通过启动脚本

#### Windows

```
# 交互式菜单
start_sync.bat

# 直接启动服务端（端口可选，默认8765）
start_sync.bat server [端口]

# 直接启动客户端
start_sync.bat client 服务端IP 端口 源目录 目标目录
```

#### Linux/Mac

```
# 确保脚本有执行权限
chmod +x start_sync.sh

# 交互式菜单
./start_sync.sh

# 直接启动服务端（端口可选，默认8765）
./start_sync.sh server [端口]

# 直接启动客户端
./start_sync.sh client 服务端IP 端口 源目录 目标目录
```

### 直接使用Python脚本

```
# 交互式菜单
python sync_tool.py

# 启动服务端
python sync_tool.py --server [--port PORT] [--log-dir LOG_DIR]

# 启动客户端
python sync_tool.py --client --server-ip IP [--port PORT] --source-dir DIR --dest-dir DIR
```

## 参数说明

- `--server`: 启动服务端模式
- `--client`: 启动客户端模式
- `--server-ip`: 服务端IP地址
- `--port`: 服务端端口，默认8765
- `--source-dir`: 客户端源目录
- `--dest-dir`: 服务端目标目录
- `--log-dir`: 服务端日志目录，默认为当前目录下的logs文件夹

## 日志

服务端会在logs目录下生成日志文件，格式为`sync_server_YYYYMMDD.log`。日志记录了同步过程中的所有操作和错误信息。

## 示例

### 启动服务端

```
python sync_tool.py --server --port 8765
```

### 启动客户端

```
python sync_tool.py --client --server-ip 192.168.1.100 --port 8765 --source-dir /path/to/source --dest-dir /path/to/destination
```

## 注意事项

1. 确保服务端和客户端之间的网络连接正常
2. 确保服务端有足够的磁盘空间
3. 同步过程中，目标目录中的同名文件将被覆盖
4. 大文件传输可能需要较长时间，请耐心等待
5. 如果同步过程中断，需要重新启动同步

## 工作原理

1. 服务端启动后，监听指定端口，等待客户端连接
2. 客户端连接到服务端后，扫描源目录下的所有文件
3. 客户端将文件信息（路径、大小、哈希值）发送给服务端
4. 服务端接收文件信息，准备接收文件
5. 客户端发送文件内容
6. 服务端接收文件内容，并验证文件哈希值
7. 重复步骤3-6，直到所有文件都同步完成
8. 服务端记录同步日志

## 故障排除

### 无法连接到服务端

- 检查服务端是否已启动
- 检查服务端IP地址和端口是否正确
- 检查网络连接是否正常
- 检查防火墙是否允许该端口的连接

### 文件同步失败

- 检查源目录和目标目录是否存在
- 检查源目录和目标目录的权限
- 检查目标目录是否有足够的磁盘空间
- 检查日志文件，查看具体错误信息

### 同步速度慢

- 检查网络带宽
- 减少同时同步的文件数量
- 考虑使用压缩传输（未实现）
